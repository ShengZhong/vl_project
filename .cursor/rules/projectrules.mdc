---
alwaysApply: true
---

# 产品团队 Cursor Rules - VisionLine 项目

> **文档版本**：v1.3  
> **最后更新**：2025-01-15  
> **适用范围**：VisionLine 项目产品团队

---

## 📋 目录

1. [总体目标](#1-总体目标)
2. [产品背景](#2-产品背景)
3. [功能点 ID 命名规范](#3-功能点-id-命名规范)
4. [文件组织结构](#4-文件组织结构)
5. [Git 分支与提交规范](#5-git-分支与提交规范)
6. [AI 辅助生成规范](#6-ai-辅助生成规范)
7. [本地数据库使用规范](#7-本地数据库使用规范)
8. [质量检查清单](#8-质量检查清单)
9. [禁止事项](#9-禁止事项)
10. [交付物联动规则](#10-交付物联动规则)
11. [Prompt 模板](#11-prompt-模板)
12. [参考规则文件](#12-参考规则文件)
13. [工作流程总结](#13-工作流程总结)
14. [最佳实践](#14-最佳实践)

---

## 1. 总体目标

使用 Cursor 作为产品部门的一站式工具，输出以下交付物：

### 1.1 核心交付物

1. **可直接部署的前端原型代码**
   - 技术栈：Umi + React + Ant Design v4
   - 包含完整的 TypeScript 类型定义
   - 集成本地数据库（SQLite）

2. **标准化的 PRD 文档**
   - 格式：Markdown
   - 包含完整的数据模型和实体关系图
   - 必须关联具体代码文件路径

### 1.2 暂时禁用的交付物

> ⚠️ **注意**：以下交付物暂时禁用，后续可能开放

- **用户操作手册**：暂不生成，保留现有文件

### 1.3 基本要求

所有交付物必须满足：
- ✅ 版本化管理（Git）
- ✅ 可协作（标准格式）
- ✅ 可追踪（功能点 ID）

---

## 2. 产品背景

### 2.1 行业定位

**出海广告营销**

### 2.2 产品方向

| 产品类型 | 核心功能 |
|---------|---------|
| **媒介服务产品** | 账户开通、充值、绑定、更名等 |
| **投放服务产品** | 素材生成、素材管理、自动投放等 |

---

## 3. 功能点 ID 命名规范

### 3.1 命名格式

```
产品简称-模块简称-序号
```

### 3.2 示例说明

| 功能点 ID | 说明 |
|-----------|------|
| `AD-ACC-001` | 广告系统-账户模块-001 |
| `AD-MAT-001` | 广告系统-素材模块-001 |
| `AD-BID-001` | 广告系统-投放模块-001 |
| `VL-USR-001` | VisionLine-用户模块-001 |

### 3.3 命名规则

| 部分 | 要求 | 说明 |
|------|------|------|
| **产品简称** | 2-3 个大写字母 | 如：AD、VL |
| **模块简称** | 3 个大写字母 | 如：ACC、MAT、USR |
| **序号** | 3 位数字 | 从 001 开始，递增编号 |

### 3.4 重要约束

> ⚠️ **功能点 ID 一旦分配，不可修改**

---

## 4. 文件组织结构

### 4.1 目录树

```
project_root/
├── docs/                                  # 📄 统一文档目录
│   ├── README.md                          # 文档索引
│   ├── prd/                               # PRD 文档
│   │   ├── README.md                      # PRD 索引
│   │   └── PRD_{功能名称}.md               # 具体 PRD
│   ├── user-manual/                       # 用户手册（⚠️ 暂时禁用）
│   │   ├── README.md                      # 手册索引
│   │   └── user_manual_{功能名称}.md       # 具体手册
│   └── summary/                           # 项目总结与 Agent 执行报告
│       ├── README.md                      # 总结索引
│       ├── {功能名称}_{功能点ID}_summary.md # 项目总结
│       └── {TYPE}_{DESCRIPTION}.md          # Agent 执行报告/修复总结
│
├── src/                                   # 💻 前端原型代码
│   ├── pages/{模块名}/                     # 页面组件
│   ├── components/                        # 公共组件
│   ├── services/                          # API 服务层
│   ├── types/                             # TypeScript 类型
│   ├── db/                                # 本地数据库
│   │   └── index.ts                       # 数据库核心实现
│   └── utils/                             # 工具函数
│
├── mock/                                  # 🔧 Mock 数据
│   └── {模块名}.ts                         # 模块 Mock 文件
│
└── .cursor/rules/                         # 📋 Cursor 规则
    ├── projectrules.mdc                   # 产品团队总规则
    ├── frontend-standards.md              # 前端代码规范
    ├── prd-standards.md                   # PRD 文档规范
    ├── database-standards.md              # 数据库使用规范
    ├── data-modeling-standards.md         # 数据建模规范
    └── user-manual-standards.md           # 用户手册规范（⚠️ 暂时禁用）
```

### 4.2 目录说明

| 目录 | 用途 | 状态 |
|------|------|------|
| `docs/prd/` | 存放 PRD 文档 | ✅ 使用中 |
| `docs/user-manual/` | 存放用户手册 | ⚠️ 暂时禁用 |
| `docs/summary/` | 存放项目总结、Agent 执行报告 | ✅ 使用中 |
| `src/pages/` | 页面组件代码 | ✅ 使用中 |
| `src/db/` | 数据库工具 | ✅ 使用中 |
| `mock/` | Mock 数据文件 | ✅ 使用中 |

---

## 5. Git 分支与提交规范

### 5.1 分支命名规范

| 分支类型 | 命名格式 | 示例 |
|---------|---------|------|
| **主分支** | `main` | `main` |
| **开发分支** | `feature/{功能点ID}_{简要描述}` | `feature/AD-ACC-001_account_opening` |
| **修复分支** | `fix/{功能点ID}_{问题描述}` | `fix/AD-ACC-001_form_validation` |

### 5.2 提交信息规范

#### 格式

```
<type>({功能点ID}): <简要描述>
```

#### Type 类型说明

| Type | 说明 | 示例场景 |
|------|------|---------|
| `feat` | 新增功能原型或代码 | 新增页面、新增组件 |
| `docs` | 更新 PRD 文档 | 更新需求文档、修改文档 |
| `fix` | 修复原型或文档问题 | Bug 修复、问题修正 |
| `style` | 调整 UI 样式或排版 | 样式优化、布局调整 |
| `refactor` | 重构代码或文档结构 | 代码重构、文档重组 |
| `test` | 添加测试用例 | 单元测试、集成测试 |

> ⚠️ **注意**：用户手册相关提交暂时禁用

#### 提交示例

```bash
feat(AD-ACC-001): 新增账户开通页面原型
docs(AD-ACC-001): 更新账户开通 PRD 文档
fix(AD-ACC-002): 修复充值流程中的表单验证问题
style(AD-MAT-001): 优化素材列表页面布局
refactor(VL-USR-003): 重构用户列表数据加载逻辑
```

### 5.3 远程仓库操作

#### 仓库地址

```
https://github.com/ShengZhong/vl_project.git
```

#### 常用命令

| 操作 | 命令 | 说明 |
|------|------|------|
| 查看仓库 | 访问 GitHub 网页 | 在线查看代码 |
| 推送代码 | `git push` | 推送到远程仓库 |
| 拉取更新 | `git pull` | 获取远程更新 |
| 查看远程 | `git remote -v` | 查看远程配置 |
| 首次推送 | `git push -u origin main` | 设置上游分支 |

#### 操作注意事项

- ✅ 推送前确保已提交所有更改（`git add` + `git commit`）
- ✅ 推送前先拉取远程更新（`git pull`）避免冲突
- ✅ 遵循提交信息规范，包含功能点 ID
- ❌ 禁止无意义的提交信息（如 "update"、"test"）

---

## 6. AI 辅助生成规范

### 6.1 生成前端原型代码

#### 必须遵循的规范

| 项目 | 要求 |
|------|------|
| **文档联动** | 必须同时生成对应的 PRD 文档 |
| **技术规范** | 遵循 `frontend-standards.md` |
| **类型定义** | 包含完整的 TypeScript 类型 |
| **用户反馈** | 所有交互必须有反馈（Loading/Success/Error）|
| **组件库版本** | 使用 Ant Design v4（禁止 v5）|

> ⚠️ **注意**：用户手册暂时禁用，不需要同步生成

### 6.2 生成 PRD 文档

#### 必须包含的内容

- ✅ 功能点 ID
- ✅ 关联的前端代码文件路径
- ✅ 完整的验收标准
- ✅ TypeScript 类型定义
- ✅ 完整的实体关系图和数据模型（参考 `data-modeling-standards.md`）

#### 参考规范

详见 `prd-standards.md` 模板规范

### 6.3 用户手册（暂时禁用）

> ⚠️ **暂时禁用**：用户手册生成功能后续可能开放

<details>
<summary>点击查看用户手册规范（暂时禁用）</summary>

- 遵循 `user-manual-standards.md` 中的模板规范
- 必须包含截图占位符（实际截图由产品人员补充）
- 必须包含常见问题解答（FAQ，至少 3-5 个）
- 步骤说明必须清晰具体，避免模糊描述

</details>

---

## 7. 本地数据库使用规范

> 📖 **详细规范**：请参考 `.cursor/rules/database-standards.md`

### 7.1 技术选型

| 项目 | 技术 |
|------|------|
| **数据库引擎** | SQLite (sql.js) |
| **存储方式** | localStorage |
| **操作方式** | 异步（async/await）|

### 7.2 核心要求

- ✅ 所有 Mock 文件必须使用数据库函数
- ❌ 禁止硬编码数据数组
- ✅ 所有数据库操作必须使用 `await`
- ✅ 新增功能时在 `src/db/index.ts` 中定义表结构

---

## 8. 质量检查清单

### 8.1 提交前必检项

在提交任何内容前，必须确认：

#### 基础规范

- [ ] 功能点 ID 已正确分配且格式符合规范
- [ ] Git 提交信息符合规范格式
- [ ] 所有文件路径遵循项目结构规范

#### 代码质量

- [ ] 前端原型代码已生成并可运行
- [ ] 代码使用 Ant Design v4，未使用 v5 组件
- [ ] TypeScript 类型定义完整
- [ ] 所有 Modal 弹框符合使用规范

#### 文档质量

- [ ] PRD 文档已按规范编写，包含所有必需章节
- [ ] PRD 和代码之间的功能点 ID 保持一致
- [ ] PRD 包含完整的数据模型和实体关系图

#### 数据库规范

- [ ] Mock 文件已集成本地数据库（不使用硬编码数据）
- [ ] 数据库表结构已在 `createTables()` 函数中定义
- [ ] 所有数据库操作都使用了 `await`（异步处理）
- [ ] 实体关系已明确定义（外键、级联规则）
- [ ] 所有外键字段已创建索引

### 8.2 暂时禁用的检查项

> ⚠️ 以下检查项暂时禁用：

- ~~用户手册已按规范编写~~（暂时禁用）

---

## 9. 禁止事项

### 9.1 文档规范禁止

| 禁止项 | 说明 |
|--------|------|
| ❌ 模糊描述 | 禁止在 PRD 中使用"优化用户体验"、"更方便"等模糊表达 |
| ❌ 无意义提交 | 禁止提交"update files"、"test"等无意义 Git 信息 |
| ❌ 版本不一致 | 禁止 PRD 和代码之间的版本不一致 |
| ❌ 缺少功能点 ID | 禁止任何交付物缺少功能点 ID |
| ❌ 根目录文档 | 禁止在根目录存放执行报告等 MD 文件，应归档至 `docs/summary/` |

### 9.2 代码规范禁止

| 禁止项 | 说明 |
|--------|------|
| ❌ 使用 AntD v5 | 禁止前端代码使用 Ant Design v5 组件 |
| ❌ 页面跳转 | 禁止直接跳转的详情/新建/编辑页面（必须使用 Modal）|

### 9.3 数据库规范禁止

| 禁止项 | 说明 |
|--------|------|
| ❌ 硬编码数据 | 禁止在 Mock 文件中使用硬编码数据数组 |
| ❌ 直接操作 localStorage | 必须通过 `src/db/index.ts` 提供的函数操作 |
| ❌ 同步调用 | 禁止同步调用数据库函数，必须使用 `await` |
| ❌ 孤立数据表 | 禁止创建无外键关联的数据表（独立实体除外）|
| ❌ 硬编码关联数据 | 禁止在详情接口返回硬编码数据，必须通过外键查询 |
| ❌ 跳过数据建模 | 禁止跳过数据建模流程直接开发功能 |

### 9.4 暂时禁用的禁止项

<details>
<summary>点击查看暂时禁用的禁止项</summary>

- ~~禁止 PRD、代码、手册之间的版本不一致~~（用户手册暂时禁用）
- ~~禁止创建已上线功能时未经评审直接替换逻辑~~（评审流程调整中）

</details>

---

## 10. 交付物联动规则

### 10.1 新增功能流程

当执行新增功能时，AI 必须按以下顺序操作：

| 步骤 | 操作内容 | 产出物 |
|------|---------|--------|
| **Step 1** | 生成功能点 ID | 如：`AD-ACC-001` |
| **Step 2** | 数据建模分析（⚠️ 必须完成）| 实体关系图、表结构 |
| **Step 3** | 创建 PRD 文档 | `docs/prd/PRD_{功能名称}.md` |
| **Step 4** | 生成前端原型代码 | `src/pages/{模块名}/` |
| **Step 5** | 配置数据库表结构 | 更新 `src/db/index.ts` |
| **Step 6** | 创建 Mock 文件 | `mock/{模块名}.ts` |
| **Step 7** | 更新索引文件 | `docs/prd/README.md` |
| **Step 8** | 更新路由配置（如需要）| `.umirc.ts` |

#### Step 2: 数据建模详细要求

> ⚠️ **必须完成**，按照 `data-modeling-standards.md` 规范：

1. 识别核心实体和关联实体
2. 定义实体属性和关系
3. 设计数据库表结构和外键
4. 明确查询场景

#### Step 3: PRD 文档要求

- 必须包含完整的数据模型章节
- 必须包含实体关系图

#### Step 5: 数据库表结构要求

- 在 `createTables()` 中添加所有实体表
- 定义外键约束和级联规则
- 为所有外键创建索引
- 更新 `addData()`、`getAllData()` 等函数支持新表

#### Step 6: Mock 文件要求

- 使用数据库函数而非硬编码数据
- 初始化关联数据（包含外键关系）
- 查询接口支持 JOIN 操作

#### 暂时禁用的步骤

> ⚠️ 用户手册生成暂时禁用

<details>
<summary>点击查看暂时禁用的步骤</summary>

- ~~Step 5: 生成用户手册~~（`docs/user-manual/user_manual_{功能名称}.md`）
- ~~Step 7: 更新用户手册索引~~（`docs/user-manual/README.md`）

</details>

### 10.2 修改功能流程

| 步骤 | 操作内容 |
|------|---------|
| **Step 1** | 同步更新 PRD 文档中的变更记录（新增版本）|
| **Step 2** | 修改前端原型代码 |
| **Step 3** | 在 Git 提交信息中注明修改内容 |

> ⚠️ 用户手册同步更新暂时禁用

### 10.3 删除功能流程

| 步骤 | 操作内容 |
|------|---------|
| **Step 1** | 标记 PRD 文档为废弃（不删除，保留历史）|
| **Step 2** | 移除前端原型代码 |
| **Step 3** | 更新索引文件（标记状态为已废弃）|

> ⚠️ 用户手册归档操作暂时禁用

---

## 11. Prompt 模板

### 11.1 创建新功能的标准 Prompt

```markdown
创建新功能：[功能名称]

功能点ID: [自动生成或手动指定，如 AD-ACC-001]
所属模块: [媒介服务/投放服务/其他]
功能背景: [为什么需要这个功能，解决什么问题]
用户角色: [运营人员/广告主/管理员]
核心场景: [用户在什么情况下使用这个功能]

⚠️ 数据建模要求：
请按照 `.cursor/rules/data-modeling-standards.md` 中的标准提示词模板，
完成以下五步数据建模流程：
1. 识别核心实体（主实体和关联实体）
2. 定义实体属性（包含主键、字段、外键）
3. 明确实体关系（1对1、1对多、多对多，外键设计）
4. 数据库表设计（SQL DDL，包含外键约束和索引）
5. 数据查询场景（列出主要查询，确保关系支持）

请生成：
1. PRD 文档（包含需求描述、交互流程、验收标准、完整数据模型）
2. 前端原型代码（Umi + React + Ant Design v4）
3. 数据库表结构（包含所有实体、外键、索引）
4. Mock 数据（包含关联数据初始化）
```

> ⚠️ **注意**：用户操作手册暂时禁用，不需要生成

### 11.2 修改现有功能的标准 Prompt

```markdown
修改功能：[功能名称]

功能点 ID: [如 AD-ACC-001]
修改内容: [具体要修改的内容]
修改原因: [为什么要修改]

请同步更新：
1. 前端原型代码
2. PRD 文档（更新变更记录）
```

> ⚠️ **注意**：用户操作手册暂时禁用，不需要更新

---

## 12. 参考规则文件

### 12.1 必读规范文档

| 规范文件 | 路径 | 说明 |
|---------|------|------|
| **前端代码规范** | `.cursor/rules/frontend-standards.md` | 技术栈、组件规范 |
| **PRD 文档规范** | `.cursor/rules/prd-standards.md` | PRD 模板、格式 |
| **数据库使用规范** | `.cursor/rules/database-standards.md` | 数据库操作规范 |
| **数据建模规范** | `.cursor/rules/data-modeling-standards.md` | ⚠️ 必读！建模流程 |

### 12.2 暂时禁用的规范

| 规范文件 | 路径 | 状态 |
|---------|------|------|
| **用户手册规范** | `.cursor/rules/user-manual-standards.md` | ⚠️ 暂时禁用 |

---

## 13. 工作流程总结

### 13.1 标准开发流程

```mermaid
graph TD
    A[需求提出] --> B[分配功能点ID]
    B --> C[创建分支]
    C --> D[数据建模]
    D --> E[编写PRD]
    E --> F[PRD定稿]
    F --> G[生成前端代码]
    G --> H[配置数据库]
    H --> I[创建Mock]
    I --> J[更新索引]
    J --> K[合并到主分支]
    K --> L[标记为已实现]
    L --> M[归档和版本管理]
```

### 13.2 简化流程图

```
需求提出 → 分配功能点ID → 创建分支
    ↓
数据建模 → 编写PRD → PRD定稿
    ↓
生成前端代码 → 配置数据库 → 创建Mock
    ↓
更新索引 → 合并到主分支
    ↓
标记为已实现 → 归档和版本管理
```

> ⚠️ **注意**：评审流程和用户手册流程暂时禁用

---

## 14. 最佳实践

### 14.1 推荐做法（DO ✅）

#### 文档编写

- ✅ 使用具体、可量化的描述
- ✅ 保持 PRD 和代码一致
- ✅ 及时更新文档变更记录

#### 代码开发

- ✅ 使用 Modal 弹框处理详情/新建/编辑
- ✅ 提供清晰的错误提示和用户反馈
- ✅ 在 Mock 文件中使用数据库存储和操作数据

#### 数据建模

- ✅ 新增功能时同步更新数据库表结构
- ✅ 先完成数据建模分析，再开始编码
- ✅ 建立正确的实体关系和外键约束
- ✅ 为所有外键创建索引以提升查询性能

### 14.2 禁止做法（DON'T ❌）

#### 文档编写

- ❌ 不要使用模糊语言
- ❌ 不要跳过质量检查清单
- ❌ 不要忘记更新索引文件

#### 代码开发

- ❌ 不要混用 Ant Design v4 和 v5
- ❌ 不要创建独立的详情/编辑页面路由

#### 数据库操作

- ❌ 不要在 Mock 文件中硬编码数据数组
- ❌ 不要直接操作 localStorage，必须使用数据库工具函数
- ❌ 不要创建没有外键关联的孤立数据表
- ❌ 不要忽略实体关系建模直接开发

---

## 📝 文档变更记录

| 版本 | 日期 | 更新内容 |
|------|------|---------|
| v1.3 | 2025-01-15 | 重构文档结构，优化可读性，增加图表和表格 |
| v1.2 | 2025-01-15 | 新增数据建模与实体关系规范，强化数据建模要求 |
| v1.1 | 2025-01-10 | 优化 Git 规范，完善质量检查清单 |
| v1.0 | 2025-01-01 | 初始版本 |

---

**当前版本**：v1.3  
**最后更新**：2025-01-15  
**维护团队**：VisionLine 产品团队
