---
alwaysApply: true
---

# 产品团队 Cursor Rules - VisionLine 项目

## 1. 总体目标

使用 Cursor 作为产品部门的一站式工具，输出交付物：

1. **可直接部署的前端原型代码**（基于 Umi + React + Ant Design v4）
2. **标准化的 PRD 文档**（Markdown 格式）
<!-- 3. **用户操作手册**（Markdown 格式）- 暂时禁用，后续可能开放 -->

所有交付物必须版本化、可协作、可追踪。

## 2. 产品背景

- **行业**：出海广告营销
- **产品方向**：
  - 媒介服务产品（账户开通、充值、绑定、更名等）
  - 投放服务产品（素材生成、素材管理、自动投放等）

## 3. 功能点 ID 命名规范

### 格式
`产品简称-模块简称-序号`

### 示例
- `AD-ACC-001`：广告系统-账户模块-001
- `AD-MAT-001`：广告系统-素材模块-001
- `AD-BID-001`：广告系统-投放模块-001
- `VL-USR-001`：VisionLine-用户模块-001

### 规则
- 产品简称：2-3 个大写字母
- 模块简称：3 个大写字母
- 序号：3 位数字，从 001 开始
- 功能点 ID 一旦分配，不可修改

## 4. 文件组织结构

```
project_root/
├── docs/                          # 统一文档目录
│   ├── README.md                  # 文档索引
│   ├── prd/                       # PRD 文档目录
│   │   ├── README.md              # PRD 索引
│   │   └── PRD_{功能名称}.md       # 具体 PRD
│   ├── user-manual/               # 用户手册目录（暂时禁用，保留现有文件）
│   │   ├── README.md              # 手册索引
│   │   └── user_manual_{功能名称}.md
│   └── summary/                   # 项目总结
│       ├── README.md              # 总结索引
│       └── {功能名称}_{功能点ID}_summary.md # 具体 项目总结文档
├── src/                           # 前端原型代码
│   ├── pages/{模块名}/             # 页面组件
│   ├── components/                # 公共组件
│   ├── services/                  # API 服务层
│   ├── types/                     # TypeScript 类型
│   ├── db/                        # 本地数据库工具
│   │   └── index.ts               # 数据库核心实现
│   └── utils/                     # 工具函数
└── .cursor/rules/                 # Cursor 规则文件
    ├── projectrules.mdc           # 产品团队总规则
    ├── frontend-standards.md      # 前端代码规范
    ├── prd-standards.md           # PRD 文档规范
    ├── database-standards.md      # 数据库使用规范
    ├── data-modeling-standards.md # 数据建模与实体关系规范
    └── user-manual-standards.md   # 用户手册规范（暂时禁用，保留文件）
```

## 5. Git 分支与提交规范

### 分支命名

- **主分支**：`main`（<!-- 已评审通过的 -->内容）
- **开发分支**：`feature/{功能点ID}_{简要描述}`
  - 示例：`feature/AD-ACC-001_account_opening`
- **修复分支**：`fix/{功能点ID}_{问题描述}`
  - 示例：`fix/AD-ACC-001_form_validation`

### 提交信息规范

**格式**：`<type>({功能点ID}): <简要描述>`

**Type 类型**：

- `feat`：新增功能原型或代码
- `docs`：更新 PRD 文档（用户手册暂时禁用）
- `fix`：修复原型或文档问题
- `style`：调整 UI 样式或排版
- `refactor`：重构代码或文档结构
- `test`：添加测试用例

**示例**：

```
feat(AD-ACC-001): 新增账户开通页面原型
docs(AD-ACC-001): 更新账户开通 PRD 文档
fix(AD-ACC-002): 修复充值流程中的表单验证问题
style(AD-MAT-001): 优化素材列表页面布局
```

### 远程仓库操作

项目已配置 GitHub 远程仓库：`https://github.com/ShengZhong/vl_project.git`

**常用操作**：

- **查看仓库**：访问 https://github.com/ShengZhong/vl_project
- **推送代码**：使用 `git push` 将本地提交推送到远程仓库
- **拉取更新**：使用 `git pull` 获取远程仓库的最新更改
- **查看远程状态**：使用 `git remote -v` 查看远程仓库配置
- **首次推送**：使用 `git push -u origin main` 设置上游分支并推送

**注意事项**：

- 推送前确保已提交所有更改（`git add` 和 `git commit`）
- 推送前建议先拉取远程更新（`git pull`）避免冲突
- 遵循提交信息规范，确保每次提交都有明确的功能点 ID 和描述

## 6. AI 辅助生成规范

### 生成前端原型代码时

- 必须同时生成对应的 PRD 文档（用户手册暂时禁用）
<!-- - 必须同时生成对应的 PRD 文档和用户手册 - 暂时禁用 -->
- 遵循 `frontend-standards.md` 中的技术规范
- 代码必须包含完整的 TypeScript 类型定义
- 所有交互操作必须有明确的用户反馈（Loading、Success、Error）
- 使用 Ant Design v4 组件，禁止使用 v5

### 生成 PRD 文档时

- 遵循 `prd-standards.md` 中的模板规范
- 必须包含功能点 ID
- 必须关联到具体的前端原型代码文件路径
- 包含完整的验收标准
- 数据模型必须有 TypeScript 定义
- 必须包含完整的实体关系图和数据模型说明（参考 `data-modeling-standards.md`）

<!-- 用户手册生成规范 - 暂时禁用，后续可能开放 -->
<!--
### 生成用户手册时

- 遵循 `user-manual-standards.md` 中的模板规范
- 必须包含截图占位符（实际截图由产品人员补充）
- 必须包含常见问题解答（FAQ，至少 3-5 个）
- 步骤说明必须清晰具体，避免模糊描述
-->

## 7. 本地数据库使用规范

> 详细的数据库使用规范请参考：`.cursor/rules/database-standards.md`

**简要说明**：

- 项目使用 **SQLite (sql.js)** 作为本地数据库，基于 localStorage 存储
- 所有 Mock 文件必须使用数据库函数，禁止硬编码数据数组
- 所有数据库操作都是异步的，必须使用 `await`
- 新增功能时需在 `src/db/index.ts` 中定义表结构

## 8. 质量检查清单

在提交任何内容前，必须确认：

- [ ] 功能点 ID 已正确分配且格式符合规范
- [ ] 前端原型代码已生成并可运行
- [ ] PRD 文档已按规范编写，包含所有必需章节
<!-- - [ ] 用户手册已按规范编写，包含操作步骤和 FAQ - 暂时禁用 -->
- [ ] PRD 和代码之间的功能点 ID 保持一致
- [ ] Git 提交信息符合规范格式
- [ ] 所有文件路径遵循项目结构规范
- [ ] 代码使用 Ant Design v4，未使用 v5 组件
- [ ] TypeScript 类型定义完整
- [ ] 所有 Modal 弹框符合使用规范
- [ ] Mock 文件已集成本地数据库（不使用硬编码数据）
- [ ] 数据库表结构已在 `createTables()` 函数中定义
- [ ] 所有数据库操作都使用了 `await`（异步处理）
- [ ] 实体关系已明确定义（外键、级联规则）
- [ ] 所有外键字段已创建索引
- [ ] PRD 包含完整的数据模型和实体关系图

## 9. 禁止事项

- ❌ 禁止在 PRD 中使用模糊描述（如"优化用户体验"、"更方便"）
- ❌ 禁止提交无意义的 Git 信息（如"update files"、"test"）
- ❌ 禁止前端代码使用 Ant Design v5 组件
- ❌ 禁止 PRD 和代码之间的版本不一致（用户手册暂时禁用）
<!-- - ❌ 禁止 PRD、代码、手册之间的版本不一致 - 暂时禁用 -->
- ❌ 禁止缺少功能点 ID 的任何交付物
- ❌ 禁止直接跳转的详情/新建/编辑页面（必须使用 Modal）
<!-- - ❌ 禁止创建已上线功能时未经评审直接替换逻辑 -->
- ❌ 禁止在 Mock 文件中使用硬编码数据数组（必须使用数据库）
- ❌ 禁止直接操作 localStorage（必须通过 `src/db/index.ts` 提供的函数）
- ❌ 禁止同步调用数据库函数（所有数据库操作都是异步的，必须使用 `await`）
- ❌ 禁止创建孤立的数据表（无外键关联），除非是独立实体
- ❌ 禁止在详情接口返回硬编码数据（必须通过外键查询关联数据）
- ❌ 禁止跳过数据建模流程直接开发功能

## 10. 交付物联动规则

### 新增功能流程

当执行新增功能时，AI 必须自动按以下顺序操作：

1. **生成功能点 ID**（如 AD-ACC-001）
2. **数据建模分析**（⚠️ 必须完成）：
   - 按照 `data-modeling-standards.md` 规范完成五步建模流程
   - 识别核心实体和关联实体
   - 定义实体属性和关系
   - 设计数据库表结构和外键
   - 明确查询场景
3. **创建 PRD 文档**：`docs/prd/PRD_{功能名称}.md`
   - 必须包含完整的数据模型章节
   - 必须包含实体关系图
4. **生成前端原型代码**：`src/pages/{模块名}/`
<!-- 5. **生成用户手册**：`docs/user-manual/user_manual_{功能名称}.md` - 暂时禁用 -->
5. **配置数据库表结构**：
   - 在 `src/db/index.ts` 的 `createTables()` 中添加所有实体表
   - 定义外键约束和级联规则
   - 为所有外键创建索引
   - 更新 `addData()`、`getAllData()` 等函数支持新表
6. **创建 Mock 文件**：`mock/{模块名}.ts`
   - 使用数据库函数而非硬编码数据
   - 初始化关联数据（包含外键关系）
   - 查询接口支持 JOIN 操作
7. **更新索引文件**：
   - `docs/prd/README.md`（添加新 PRD 条目）
   <!-- - `docs/user-manual/README.md`（添加新手册条目）- 暂时禁用 -->
8. **更新路由配置**：`.umirc.ts`（如需要）

### 修改功能流程

当修改现有功能时：

1. **同步更新 PRD 文档**中的变更记录（新增版本）
2. **修改前端原型代码**
<!-- 3. **同步更新用户手册**中的相关步骤 - 暂时禁用 -->
3. **在 Git 提交信息中注明修改内容**

### 删除功能流程

当删除功能时：

1. **标记 PRD 文档为废弃**（不删除，保留历史）
2. **移除前端原型代码**
<!-- 3. **归档用户手册**（移至 `docs/user-manual/archived/`）- 暂时禁用 -->
3. **更新索引文件**（标记状态为已废弃）

## 11. Prompt 模板

### 创建新功能的标准 Prompt

```
创建新功能：[功能名称]

功能点ID: [自动生成或手动指定，如 AD-ACC-001]
所属模块: [媒介服务/投放服务/其他]
功能背景: [为什么需要这个功能，解决什么问题]
用户角色: [运营人员/广告主/管理员]
核心场景: [用户在什么情况下使用这个功能]

⚠️ 数据建模要求：
请按照 `.cursor/rules/data-modeling-standards.md` 中的标准提示词模板，
完成以下五步数据建模流程：
1. 识别核心实体（主实体和关联实体）
2. 定义实体属性（包含主键、字段、外键）
3. 明确实体关系（1对1、1对多、多对多，外键设计）
4. 数据库表设计（SQL DDL，包含外键约束和索引）
5. 数据查询场景（列出主要查询，确保关系支持）

请生成：
1. PRD 文档（包含需求描述、交互流程、验收标准、完整数据模型）
2. 前端原型代码（Umi + React + Ant Design v4）
3. 数据库表结构（包含所有实体、外键、索引）
4. Mock 数据（包含关联数据初始化）
<!-- 5. 用户操作手册（包含步骤说明、注意事项、FAQ）- 暂时禁用 -->
```

### 修改现有功能的标准 Prompt

```
修改功能：[功能名称]

功能点 ID: [如 AD-ACC-001]
修改内容: [具体要修改的内容]
修改原因: [为什么要修改]

请同步更新：
1. 前端原型代码
2. PRD 文档（更新变更记录）
<!-- 3. 用户操作手册（更新相关步骤）- 暂时禁用 -->
```

## 12. 参考其他规则文件

- **前端代码规范**：详见 `.cursor/rules/frontend-standards.md`
- **PRD 文档规范**：详见 `.cursor/rules/prd-standards.md`
- **数据库使用规范**：详见 `.cursor/rules/database-standards.md`
- **数据建模与实体关系规范**：详见 `.cursor/rules/data-modeling-standards.md`（⚠️ 必读）
<!-- - **用户手册规范**：详见 `.cursor/rules/user-manual-standards.md` - 暂时禁用 -->

## 13. 工作流程总结

```
需求提出 → 分配功能点ID → 创建分支
    ↓
编写PRD <!-- → 评审PRD --> → PRD定稿
    ↓
生成前端代码 → 更新索引（用户手册暂时禁用）
    ↓
<!-- 代码评审 → 文档审核 → -->合并到主分支
    ↓
标记为已实现 → 归档和版本管理
```

## 14. 最佳实践

### DO ✅

- 使用具体、可量化的描述
- 保持 PRD 和代码一致（用户手册暂时禁用）
<!-- - 保持 PRD、代码、手册三者一致 - 暂时禁用 -->
- 及时更新文档变更记录
- 使用 Modal 弹框处理详情/新建/编辑
- 提供清晰的错误提示和用户反馈
- 在 Mock 文件中使用数据库存储和操作数据
- 新增功能时同步更新数据库表结构
- 先完成数据建模分析，再开始编码
- 建立正确的实体关系和外键约束
- 为所有外键创建索引以提升查询性能

### DON'T ❌

- 不要使用模糊语言
- 不要跳过质量检查清单
- 不要忘记更新索引文件
- 不要混用 Ant Design v4 和 v5
- 不要创建独立的详情/编辑页面路由
- 不要在 Mock 文件中硬编码数据数组
- 不要直接操作 localStorage，必须使用数据库工具函数
- 不要创建没有外键关联的孤立数据表
- 不要忽略实体关系建模直接开发

---

**最后更新**：2025-01-15  
**版本**：v1.2  
**v1.2 更新内容**：新增数据建模与实体关系规范，强化数据建模要求
