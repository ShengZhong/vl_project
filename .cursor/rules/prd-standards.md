# PRD 文档编写规范

## 文档目标

- 清晰定义产品功能需求
- 作为开发团队的实现依据
- 作为测试团队的验收标准
- 支持版本化管理和追踪

## 文档命名规范

- **格式**：`PRD_{功能名称}.md`
- **示例**：`PRD_账户开通管理.md`、`PRD_素材批量上传.md`
- 使用中文命名（便于团队沟通）
- 文件名避免特殊字符和空格

## 完整文档模板

```markdown
# PRD: {功能名称}

## 文档信息

- **功能点 ID**: {如 AD-ACC-001}
- **产品模块**: {媒介服务/投放服务/其他}
- **创建日期**: {YYYY-MM-DD}
- **创建人**: {姓名}
- **当前版本**: v1.0
- **最后更新**: {YYYY-MM-DD}
- **文档状态**: {草稿/待评审/已评审/已实现}

## 1. 背景与目标 (Background & Objectives)

### 1.1 业务背景

{为什么需要这个功能？当前存在什么问题？}

**示例**：
当前账户开通流程需要手动操作，每个账户开通需要 30 分钟，且容易出错。
随着业务量增长，手动操作已无法满足需求，需要提供在线自助开通功能。

### 1.2 目标用户

- **主要用户**：{如：运营人员、广告主}
- **次要用户**：{如：管理员、审核人员}

### 1.3 核心目标

1. {可量化的目标1，如：提升操作效率 50%，单账户开通时间降至 5 分钟}
2. {可量化的目标2，如：减少人工错误率至 2% 以下}
3. {可量化的目标3，如：支持日均 200+ 账户开通}

## 2. 用户故事 (User Stories)

### Story 1: {故事标题}

- **作为** {用户角色，如：运营人员}
- **我想要** {做什么，如：快速创建广告账户}
- **以便于** {达成什么目标，如：及时响应客户需求}
- **优先级**: 🔴 P0 / 🟡 P1 / 🟢 P2

**验收条件**：
- 能在 5 分钟内完成账户创建
- 系统自动校验必填信息
- 创建成功后发送通知

### Story 2: {故事标题}

{重复以上结构，可以有多个用户故事}

## 3. 功能需求 (Functional Requirements)

### 3.1 功能点 1: {功能名称}

- **功能描述**: {详细描述功能是什么}
- **输入**: {用户需要提供什么数据}
- **处理**: {系统如何处理这些数据}
- **输出**: {用户看到什么结果}
- **异常处理**: {各种错误情况如何处理}

**示例**：

#### 功能点 1: 账户基本信息填写

- **功能描述**: 用户填写账户的基本信息，包括账户名称、类型、联系方式等
- **输入**: 
  - 账户名称（必填，2-50 字符）
  - 账户类型（必填，单选：个人/企业）
  - 联系邮箱（选填，邮箱格式）
  - 联系电话（选填，手机号格式）
- **处理**:
  - 实时校验字段格式
  - 检查账户名称唯一性
  - 自动保存草稿（每 30 秒）
- **输出**:
  - 校验通过：允许提交
  - 校验失败：显示具体错误提示
- **异常处理**:
  - 账户名称重复：提示"该账户名称已存在，请更换"
  - 网络超时：提示"网络异常，请稍后重试"

### 3.2 功能点 2: {功能名称}

{重复以上结构}

## 4. 交互流程 (User Flow)

### 4.1 主流程

1. 用户点击 {按钮/入口}
2. 系统展示 {页面/弹框}
3. 用户输入/选择 {数据}
4. 用户点击 {提交/确认} 按钮
5. 系统校验数据
   - 校验通过 → 进入步骤 6
   - 校验失败 → 显示错误提示，返回步骤 3
6. 系统执行 {业务逻辑}
7. 系统展示 {成功/失败} 提示
8. {后续操作：刷新列表/关闭弹框/跳转页面}

### 4.2 异常流程

#### 场景1：数据校验失败

- **触发条件**：用户提交的数据不符合校验规则
- **系统行为**：
  - 在对应字段下方显示红色错误提示
  - 保持弹框打开状态
  - 高亮显示错误字段
- **用户操作**：修改错误字段后重新提交

#### 场景2：网络请求失败

- **触发条件**：API 调用超时或返回错误
- **系统行为**：
  - 显示全局错误提示："操作失败，请稍后重试"
  - 记录错误日志
  - 保留用户已填写的数据
- **用户操作**：点击"重试"或关闭弹框

#### 场景3：权限不足

- **触发条件**：用户无该功能的操作权限
- **系统行为**：
  - 显示提示："您没有权限执行此操作，请联系管理员"
  - 禁用相关按钮
- **用户操作**：联系管理员分配权限

### 4.3 流程图

```
[开始] → [点击新建按钮]
    ↓
[打开新建弹框]
    ↓
[填写表单] → [实时校验]
    ↓
[点击提交] → [数据校验]
    ↓
  [是否通过?]
    ├─ 是 → [调用API] → [成功?]
    │                    ├─ 是 → [显示成功提示] → [关闭弹框] → [刷新列表] → [结束]
    │                    └─ 否 → [显示错误提示] → [返回表单]
    └─ 否 → [显示校验错误] → [返回表单]
```

## 5. UI 原型 (UI Wireframes)

### 5.1 页面结构

- **页面类型**: {列表页/表单页/详情页}
- **布局方式**: {卡片布局/表格布局}
- **核心组件**: {Table / Form / Modal / Descriptions}

### 5.2 字段定义

| 字段名称 | 字段类型 | 是否必填 | 校验规则 | 默认值 | 说明 |
|---------|---------|---------|---------|--------|------|
| 账户名称 | Input   | ✅ 是    | 长度 2-50，唯一性 | -      | 账户的唯一标识 |
| 账户类型 | Select  | ✅ 是    | 枚举值：个人/企业 | 个人账户 | 选择后不可修改 |
| 联系邮箱 | Input   | ❌ 否    | 邮箱格式验证 | -      | 用于接收通知 |
| 联系电话 | Input   | ❌ 否    | 手机号格式 | -      | 11 位数字 |
| 账户状态 | Radio   | ✅ 是    | 枚举值：启用/禁用 | 启用   | 仅管理员可修改 |

### 5.3 按钮与操作

| 按钮名称 | 位置 | 样式 | 权限要求 | 操作说明 |
|---------|------|------|---------|---------|
| 新建账户 | 页面右上角 | Primary | 创建权限 | 打开新建弹框 |
| 编辑 | 操作列 | Link | 编辑权限 | 打开编辑弹框，回填数据 |
| 删除 | 操作列 | Link Danger | 删除权限 | 二次确认后删除 |
| 查看详情 | 操作列 | Link | 查看权限 | 打开只读详情弹框 |

### 5.4 原型链接

- **Figma 链接**：{https://figma.com/file/...}
- **本地代码路径**：`src/pages/{模块名}/{文件名}.tsx`
- **相关组件**：`src/components/{组件名}/index.tsx`

## 6. 数据定义 (Data Schema)

### 6.1 API 接口

#### 获取账户列表

| 项目 | 内容 |
|-----|------|
| 接口路径 | GET /api/accounts |
| 请求参数 | `{ pageNum: number, pageSize: number, keyword?: string, status?: string }` |
| 响应数据 | `{ code: number, message: string, data: { list: Account[], total: number } }` |
| 错误码 | 200: 成功, 400: 参数错误, 401: 未授权, 500: 服务器错误 |

#### 创建账户

| 项目 | 内容 |
|-----|------|
| 接口路径 | POST /api/accounts |
| 请求参数 | `{ name: string, type: string, email?: string, phone?: string }` |
| 响应数据 | `{ code: number, message: string, data: Account }` |
| 错误码 | 200: 成功, 400: 参数错误, 409: 账户名称已存在 |

#### 更新账户

| 项目 | 内容 |
|-----|------|
| 接口路径 | PUT /api/accounts/:id |
| 请求参数 | `{ name?: string, email?: string, phone?: string, status?: string }` |
| 响应数据 | `{ code: number, message: string, data: Account }` |
| 错误码 | 200: 成功, 404: 账户不存在, 409: 账户名称已存在 |

#### 删除账户

| 项目 | 内容 |
|-----|------|
| 接口路径 | DELETE /api/accounts/:id |
| 请求参数 | - |
| 响应数据 | `{ code: number, message: string }` |
| 错误码 | 200: 成功, 404: 账户不存在, 403: 无权限删除 |

### 6.2 数据模型

```typescript
// 账户数据模型
interface Account {
  id: string;                    // 账户 ID
  name: string;                  // 账户名称
  type: 'personal' | 'enterprise'; // 账户类型
  email?: string;                // 联系邮箱
  phone?: string;                // 联系电话
  status: 'active' | 'inactive'; // 账户状态
  createdBy: string;             // 创建人 ID
  createdAt: string;             // 创建时间（ISO 8601）
  updatedAt: string;             // 更新时间（ISO 8601）
}

// 账户列表查询参数
interface AccountListParams {
  pageNum: number;     // 页码，从 1 开始
  pageSize: number;    // 每页条数
  keyword?: string;    // 搜索关键词
  type?: string;       // 账户类型筛选
  status?: string;     // 状态筛选
  sortBy?: string;     // 排序字段
  sortOrder?: 'asc' | 'desc'; // 排序方向
}

// 账户列表响应
interface AccountListResponse {
  code: number;
  message: string;
  data: {
    list: Account[];
    total: number;
    pageNum: number;
    pageSize: number;
  };
}
```

## 7. 业务规则 (Business Rules)

### 7.1 校验规则

1. **账户名称**：
   - 长度：2-50 个字符
   - 格式：支持中文、英文、数字、下划线
   - 唯一性：同一租户下账户名称不可重复
   - 不可修改：账户创建后名称不可修改

2. **邮箱**：
   - 格式：符合标准邮箱格式（如 user@example.com）
   - 唯一性：非必填，但填写后需保证唯一

3. **手机号**：
   - 格式：11 位数字
   - 验证：需要通过手机号格式校验

### 7.2 权限规则

| 角色 | 查看 | 创建 | 编辑 | 删除 | 说明 |
|-----|-----|-----|-----|-----|-----|
| 管理员 | ✅ | ✅ | ✅ | ✅ | 全部权限 |
| 运营人员 | ✅ | ✅ | ✅ | ❌ | 不可删除账户 |
| 普通用户 | ✅ | ❌ | ❌ | ❌ | 仅可查看 |
| 访客 | ❌ | ❌ | ❌ | ❌ | 无任何权限 |

### 7.3 状态流转

```
[新建] → [草稿]
          ↓
       [提交审核] → [审核中]
                      ↓
                   [审核通过] → [已启用]
                      |
                   [审核拒绝] → [已拒绝] → 可重新提交
                      
[已启用] ⇄ [已禁用]（管理员可切换）

[已启用/已禁用] → [删除] → [已删除]（软删除，不可恢复）
```

### 7.4 并发控制

- 使用乐观锁机制，基于 `updatedAt` 字段进行版本控制
- 编辑冲突时提示："该记录已被他人修改，请刷新后重试"

## 8. 非功能需求 (Non-Functional Requirements)

### 8.1 性能要求

- **列表加载时间**：< 2 秒（1000 条数据以内）
- **表单提交响应**：< 1 秒
- **搜索响应时间**：< 1 秒
- **并发支持**：支持 100+ 用户同时在线操作

### 8.2 兼容性

- **浏览器**：Chrome 90+, Safari 14+, Edge 90+, Firefox 88+
- **屏幕分辨率**：≥ 1366x768
- **移动端**：暂不支持（后续版本考虑）

### 8.3 可用性

- **操作步骤**：关键操作步骤 ≤ 3 步
- **错误提示**：必须清晰明确，并提供解决方案
- **加载反馈**：所有异步操作必须有 loading 状态
- **成功反馈**：操作成功后必须有明确提示

### 8.4 安全性

- **数据加密**：敏感字段（如邮箱、电话）传输时加密
- **操作日志**：记录所有增删改操作，包含操作人、时间、内容
- **权限校验**：前后端双重校验权限

## 9. 验收标准 (Acceptance Criteria)

### 9.1 功能验收

- [ ] 用户可以成功创建账户，填写必填字段后提交成功
- [ ] 系统正确校验所有字段格式和必填项
- [ ] 账户名称重复时显示清晰的错误提示
- [ ] 编辑账户时正确回填数据
- [ ] 删除账户时弹出二次确认对话框
- [ ] 操作成功后自动刷新列表并定位到对应记录
- [ ] 搜索和筛选功能正常工作
- [ ] 分页功能正常，显示总条数

### 9.2 UI 验收

- [ ] 页面布局符合设计规范
- [ ] 按钮状态正确（正常/禁用/加载中）
- [ ] 表单校验提示位置和样式准确
- [ ] Modal 弹框宽度、高度合适
- [ ] 响应式布局在不同屏幕尺寸下正常显示
- [ ] 所有文案无错别字

### 9.3 性能验收

- [ ] 列表加载时间 < 2 秒
- [ ] 表单提交响应时间 < 1 秒
- [ ] 无明显的页面卡顿
- [ ] 无内存泄漏（长时间使用后内存不持续增长）

### 9.4 异常验收

- [ ] 网络异常时显示友好提示
- [ ] 权限不足时禁用相关操作并提示
- [ ] 数据冲突时正确处理
- [ ] 表单校验失败时不关闭弹框

## 10. 变更记录 (Change Log)

| 版本号 | 日期 | 变更类型 | 变更内容 | 变更人 | 评审状态 |
|-------|------|---------|---------|--------|---------|
| v1.0  | 2025-01-15 | 新增 | 初始版本，定义核心功能 | 张三 | 已评审 |
| v1.1  | 2025-01-20 | 优化 | 新增批量导入功能 | 李四 | 待评审 |
| v1.2  | 2025-01-25 | 修复 | 修正字段校验规则 | 王五 | 已评审 |

## 11. 附录 (Appendix)

### 11.1 相关文档

- **用户手册**：`docs/user-manual/user_manual_{功能名称}.md`
- **前端代码**：`src/pages/{模块名}/{功能名}.tsx`
- **API 文档**：{链接}
- **测试用例**：{链接}

### 11.2 术语表

| 术语 | 英文 | 说明 |
|-----|------|------|
| 账户 | Account | 广告平台的账户实体 |
| 媒介 | Media | 广告投放的媒体平台 |
| CPC | Cost Per Click | 每次点击成本 |
| CTR | Click Through Rate | 点击率 |
| ROI | Return On Investment | 投资回报率 |

### 11.3 参考资料

- 竞品分析：{链接}
- 行业标准：{链接}
- 用户调研报告：{链接}

---

**审核记录**

| 审核人 | 审核日期 | 审核意见 | 审核结果 |
|-------|---------|---------|---------|
| 产品经理 | 2025-01-15 | 需求清晰，通过 | ✅ 通过 |
| 技术负责人 | 2025-01-16 | 技术可行，通过 | ✅ 通过 |
| UI 设计师 | 2025-01-16 | 交互合理，通过 | ✅ 通过 |
```

## PRD 编写注意事项

### ✅ 好的实践

1. **使用具体、可量化的目标**
   - 好：提升操作效率 30%，单次操作时间从 10 分钟降至 7 分钟
   - 差：提升用户体验

2. **明确的验收标准**
   - 每个功能点有清晰的验收条件
   - 验收条件可直接转化为测试用例

3. **完整的异常处理**
   - 覆盖各种边界情况
   - 提供明确的错误提示文案

4. **关联代码路径**
   - 便于开发人员快速定位
   - 保持文档与代码同步

### ❌ 禁止的做法

1. **使用模糊描述**
   - 禁止："优化体验"、"更方便"、"更快"
   - 应该：具体说明优化什么，如何量化

2. **缺少功能点 ID**
   - 每个 PRD 必须有唯一的功能点 ID

3. **没有验收标准**
   - 必须提供清晰的功能、UI、性能验收标准

4. **与前端代码版本不一致**
   - PRD 更新时必须同步更新前端代码
   - 在变更记录中注明

## AI 生成 PRD 时的 Checklist

- [ ] 包含完整的文档信息（ID、版本、日期、状态）
- [ ] 背景和目标清晰且可量化
- [ ] 用户故事完整且有优先级
- [ ] 功能需求有详细的输入/处理/输出/异常描述
- [ ] 交互流程完整（主流程 + 异常流程 + 流程图）
- [ ] UI 原型有字段定义表和按钮操作说明
- [ ] 数据模型有完整的 TypeScript 定义
- [ ] API 接口定义完整（路径、参数、响应、错误码）
- [ ] 业务规则明确（校验、权限、状态流转）
- [ ] 验收标准可直接用于测试
- [ ] 关联了前端代码路径和用户手册路径

---

**最后更新**：2025-01-15  
**版本**：v1.0

